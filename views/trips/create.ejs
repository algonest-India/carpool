<div class="row">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="mb-2">Create a Trip</h1>
        <p class="text-muted mb-0">Share your journey and reduce travel costs</p>
      </div>
      <div class="d-flex gap-2">
        <button type="button" class="btn btn-outline-secondary" onclick="window.history.back()">
          â† Cancel
        </button>
      </div>
    </div>
  </div>
</div>

<% if (typeof error !== 'undefined') { %>
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>âš ï¸ Error:</strong> <%= error %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% } %>

<% if (typeof messages !== 'undefined' && messages.error) { %>
  <% messages.error.forEach(function(message) { %>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <strong>âš ï¸ Error:</strong> <%= message %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% }); %>
<% } %>

<% if (typeof messages !== 'undefined' && messages.success) { %>
  <% messages.success.forEach(function(message) { %>
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <strong>âœ… Success:</strong> <%= message %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% }); %>
<% } %>

<div class="row mt-4">
  <div class="col-lg-7">
    <div class="card shadow-sm border-0 h-100">
      <div class="card-header bg-primary text-white">
        <h2 class="mb-0">ğŸ“ Trip Details</h2>
      </div>
      <div class="card-body p-4">
        <form action="/trips/create" method="POST" id="createTripForm">
          <div class="mb-4">
            <label for="origin_text" class="form-label fw-semibold">
              ğŸ“ Origin (Address)
            </label>
            <div class="input-group">
              <span class="input-group-text bg-light">
                <i class="fas fa-map-marker-alt text-primary"></i>
              </span>
              <input 
                type="text" 
                class="form-control" 
                id="origin_text" 
                name="origin_text" 
                placeholder="e.g., 123 Main St, City, State" 
                required
                autocomplete="off"
                aria-describedby="originHelp originError"
              >
            </div>
            <small id="originHelp" class="text-muted">Type an address and select from suggestions</small>
            <div id="originError" class="invalid-feedback">Please enter an origin address.</div>
          </div>

          <div class="mb-4">
            <label for="destination_text" class="form-label fw-semibold">
              ğŸ¯ Destination (Address)
            </label>
            <div class="input-group">
              <span class="input-group-text bg-light">
                <i class="fas fa-flag-checkered text-danger"></i>
              </span>
              <input 
                type="text" 
                class="form-control" 
                id="destination_text" 
                name="destination_text" 
                placeholder="e.g., 456 Oak Ave, City, State" 
                required
                autocomplete="off"
              >
            </div>
            <small class="text-muted">Type an address and select from suggestions</small>
          </div>

          <div class="mb-4">
            <label for="departure_timestamp" class="form-label fw-semibold">
              ğŸ“… Departure Date & Time
            </label>
            <div class="input-group">
              <span class="input-group-text bg-light">
                <i class="fas fa-calendar-alt text-info"></i>
              </span>
              <input 
                type="datetime-local" 
                class="form-control" 
                id="departure_timestamp" 
                name="departure_timestamp" 
                required
                aria-describedby="departureError"
              >
            </div>
            <div id="departureError" class="invalid-feedback">Please enter a valid departure date and time.</div>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <label for="available_seats" class="form-label fw-semibold">
                ğŸª‘ Available Seats
              </label>
              <div class="input-group">
                <span class="input-group-text bg-light">
                  <i class="fas fa-users text-warning"></i>
                </span>
                <input 
                  type="number" 
                  class="form-control" 
                  id="available_seats" 
                  name="available_seats" 
                  min="1" 
                  max="8" 
                  value="1" 
                  required
                  aria-describedby="seatsError"
                >
                <div id="seatsError" class="invalid-feedback">Please enter a number of seats between 1 and 8.</div>
              </div>
            </div>
            <div class="col-md-6">
              <label for="price" class="form-label fw-semibold">
                ğŸ’° Price per Seat
              </label>
              <div class="input-group">
                <span class="input-group-text bg-light">
                  <i class="fas fa-rupee-sign text-success"></i>
                </span>
                <input 
                  type="number" 
                  class="form-control" 
                  id="price" 
                  name="price" 
                  step="0.01" 
                  min="0" 
                  placeholder="0.00"
                  aria-describedby="priceHelp priceError"
                >
              </div>
              <small id="priceHelp" class="text-muted">Leave blank for free ride</small>
              <div id="priceError" class="invalid-feedback">Please enter a valid price (or leave blank).</div>
            </div>
          </div>

          <div class="mb-4">
            <label for="description" class="form-label fw-semibold">
              ğŸ“ Description/Notes
            </label>
            <textarea 
              class="form-control" 
              id="description" 
              name="description" 
              rows="3" 
              placeholder="Any special information about the trip? (e.g., luggage space, music preferences, pet policy)"
            ></textarea>
            <small class="text-muted">Help passengers know what to expect</small>
          </div>

          <!-- Hidden field for route GeoJSON -->
          <input type="hidden" id="route_geojson" name="route_geojson" value="{}">

          <div class="d-grid gap-2 d-md-flex">
            <button type="submit" class="btn btn-primary btn-lg flex-fill" id="submitBtn">
              <i class="fas fa-plus-circle me-2"></i>Create Trip
            </button>
            <button type="button" class="btn btn-outline-secondary btn-lg" onclick="window.history.back()">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-5">
    <div class="card shadow-sm border-0 mb-3">
      <div class="card-header bg-info text-white">
        <h2 class="mb-0">ğŸ—ºï¸ Route Map</h2>
      </div>
      <div class="card-body p-0">
        <div id="map" class="map-large" role="application" aria-label="Map used to pick route"></div>
        <div class="p-3 bg-light border-top">
          <div class="row text-center">
            <div class="col-6">
              <div class="text-muted small mb-1">ğŸ“ Distance</div>
              <strong id="distance" class="text-primary">-</strong>
            </div>
            <div class="col-6">
              <div class="text-muted small mb-1">â±ï¸ Duration</div>
              <strong id="duration" class="text-info">-</strong>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Tips Card -->
    <div class="card shadow-sm border-0">
      <div class="card-header bg-warning text-dark">
        <h6 class="mb-0">ğŸ’¡ Tips</h6>
      </div>
      <div class="card-body p-3">
        <ul class="small mb-0">
          <li>Enter complete addresses for accurate routing</li>
          <li>Set a fair price based on distance and fuel costs</li>
          <li>Be specific about pickup locations and times</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script src="/js/trips.js"></script>